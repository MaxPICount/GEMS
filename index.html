<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>CV & Cover Letter Generator</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

    <script type="importmap">
        {
          "imports": {
            "vue": "https://unpkg.com/vue@3/dist/vue.esm-browser.js",
            "vue3-tags-input": "https://esm.sh/vue3-tags-input",
            "jspdf": "https://esm.sh/jspdf",
            "jspdf-autotable": "https://esm.sh/jspdf-autotable"
          }
        }
    </script>

	<script type="module" src="script.js"></script>
    <link href="style.css" rel="stylesheet">

</head>
<body>
    <div id="app">
        <div class="cv-builder">

            <!-- form -->
            <div class="form-panel">
                <h2>CV Generator</h2>

                <div class="mb-3">
                    <label>Name:</label>
                    <input v-model="form.name" class="form-control"/>
                </div>
                <div class="mb-3">
                    <label>Email:</label>
                    <input v-model="form.email" class="form-control"/>
                </div>
                <div class="mb-3">
                    <label>Phone:</label>
                    <input v-model="form.phone" class="form-control"/>
                </div>
                <div class="mb-3">
                    <label>Job Role:</label>
                    <input v-model="form.position" class="form-control"/>
                </div>
                <div class="mb-3">
                    <label>Experience:</label>
                    <div v-if="form.experience.length" class="mt-3">
                        <div class="card mb-2" v-for="(exp, index) in form.experience" :key="index">
                            <div class="card-body">
                                <h6 class="card-title">{{ exp.position }} at {{ exp.company }}</h6>
                                <h6 class="card-subtitle text-muted">{{ exp.period }}</h6>
                                <p class="card-text">{{ exp.description }}</p>
                                <button @click="openModalExperience(index)" class="btn btn-sm btn-outline-primary">Edit
                                </button>
                                <button @click="removeExperience(index)" class="btn btn-sm btn-outline-danger">Delete
                                </button>
                            </div>
                        </div>
                    </div>

                    <button @click="openModalExperience()" class="btn btn-success">Add Experience</button>

                </div>
                <div class="mb-3">
                    <label>Education:</label>
                    <div v-if="form.education.length" class="mt-3">
                        <div class="card mb-2" v-for="(education, index) in form.education" :key="index">
                            <div class="card-body">
                                <h6 class="card-title">{{ education.position }} at {{ education.school }}</h6>
                                <h6 class="card-subtitle text-muted">{{ education.period }}</h6>
                                <p class="card-text">{{ education.description }}</p>
                                <button @click="openModalEducation(index)" class="btn btn-sm btn-outline-primary">Edit
                                </button>
                                <button @click="removeEducation(index)" class="btn btn-sm btn-outline-danger">Delete
                                </button>
                            </div>
                        </div>
                    </div>

                    <button @click="openModalEducation()" class="btn btn-success">Add Education</button>
                </div>
                <div class="mb-3">
                    <label>Skills:</label>
                    <textarea v-model="form.skills" class="form-control"></textarea>
                </div>
                <div class="mb-3">
                    <label>Hobbies:</label>
                    <textarea v-model="form.hobbies" class="form-control"></textarea>
                </div>
                <div class="mb-3">
                    <label>Languages:</label>
                    <textarea v-model="form.languages" class="form-control"></textarea>
                </div>

                <div class="d-grid gap-2 mt-3">
                    <button @click="customizeWithAI" class="btn btn-primary">
                        <span v-if="isWaitingAI" class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
                        Generate Cover Letter AI
                    </button>
                </div>
            </div>

            <!-- preview -->
            <div class="preview-panel">
                <iframe id="preview"></iframe>
            </div>

        </div>
        <div id="cv-template" class="d-none pdf-template"></div>
        <div id="cover-letter-template" class="d-none pdf-template"></div>
        <div class="modal fade" id="experienceModal" tabindex="-1" aria-hidden="true">
            <div class="modal-dialog modal-lg modal-dialog-centered">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">
                            {{ editIndex === null ? 'Add Experience' : 'Edit Experience' }}
                        </h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <div class="row g-2">
                            <div class="col-md-4">
                                <input v-model="currentExperience.company" placeholder="Company" class="form-control"/>
                            </div>
                            <div class="col-md-4">
                                <input v-model="currentExperience.position" placeholder="Position" class="form-control"/>
                            </div>
                            <div class="col-md-4">
                                <input v-model="currentExperience.period" placeholder="Dates" class="form-control"/>
                            </div>
                            <div class="col-12 mt-2">
                                <textarea v-model="currentExperience.description" placeholder="Description"
                                          class="form-control"></textarea>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                        <button
                                type="button"
                                class="btn btn-primary"
                                @click="affectExperience"
                        >
                            {{ editIndex === null ? 'Add Experience' : 'Save Changes' }}
                        </button>
                    </div>
                </div>
            </div>
        </div>
        <div class="modal fade" id="educationModal" tabindex="-1" aria-hidden="true">
            <div class="modal-dialog modal-lg modal-dialog-centered">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">
                            {{ editIndex === null ? 'Add Education' : 'Edit Education' }}
                        </h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <div class="row g-2">
                            <div class="col-md-4">
                                <input v-model="currentEducation.school" placeholder="School" class="form-control"/>
                            </div>
                            <div class="col-md-4">
                                <input v-model="currentEducation.degree" placeholder="Degree" class="form-control"/>
                            </div>
                            <div class="col-md-4">
                                <input v-model="currentEducation.period" placeholder="Dates" class="form-control"/>
                            </div>
                            <div class="col-12 mt-2">
                                <textarea v-model="currentEducation.description" placeholder="Description"
                                          class="form-control"></textarea>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                        <button
                                type="button"
                                class="btn btn-primary"
                                @click="affectEducation"
                        >
                            {{ editIndex === null ? 'Add Education' : 'Save Changes' }}
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>
</html>
